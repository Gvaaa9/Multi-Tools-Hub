<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Internet Speed Test - Multi-Tools Hub</title>
  <meta name="description" content="Quick internet speed test (ping, download estimate) using lightweight requests." />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link href="../../assets/css/style.css" rel="stylesheet" />
  <style>
    .gauge{font-size:2.25rem}
  </style>
</head>
<body>
  <div id="header"></div>
  <div class="tool-page">
    <div class="container py-5">
      <div class="row justify-content-center">
        <div class="col-lg-8">
          <div class="tool-content text-center">
            <div class="tool-header">
              <h1 class="mb-1">Internet Speed Test</h1>
              <p class="text-muted">Lightweight ping and download estimate</p>
            </div>
            <div class="mb-3 d-flex gap-2 justify-content-center">
              <button id="start" class="btn btn-primary">Start Test</button>
              <button id="reset" class="btn btn-outline-secondary">Reset</button>
            </div>
            <div class="row text-start g-3">
              <div class="col-md-4"><div class="border rounded p-3"><div class="text-muted">Ping</div><div id="ping" class="gauge">-</div><small class="text-muted">ms</small></div></div>
              <div class="col-md-4"><div class="border rounded p-3"><div class="text-muted">Jitter</div><div id="jitter" class="gauge">-</div><small class="text-muted">ms</small></div></div>
              <div class="col-md-4"><div class="border rounded p-3"><div class="text-muted">Download</div><div id="down" class="gauge">-</div><small class="text-muted">Mbps (est.)</small></div></div>
            </div>
            <div class="ad-banner text-center mt-4"><div class="ad-placeholder bg-light border rounded p-3"><p class="text-muted mb-0">Advertisement Space</p></div></div>
            <small class="text-muted d-block mt-2">Estimates only; browser & route affect results.</small>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div id="footer"></div>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script src="../../assets/js/main.js"></script>
  <script>
    const pingEl = document.getElementById('ping');
    const jitterEl = document.getElementById('jitter');
    const downEl = document.getElementById('down');
    const TEST_URL = 'https://upload.wikimedia.org/wikipedia/commons/3/3f/Placeholder_view_vector.svg'; // ~3KB
    const DL_URL = 'https://upload.wikimedia.org/wikipedia/commons/4/47/PNG_transparency_demonstration_1.png'; // ~400KB

    function fmt(v){ return isFinite(v)? v.toFixed(0):'-'; }
    async function pingTest(samples=6){
      const times=[];
      for(let i=0;i<samples;i++){
        const t0=performance.now();
        await fetch(TEST_URL+`?cache=${Math.random()}`,{cache:'no-store'}).then(r=>r.blob()).catch(()=>{});
        const dt=performance.now()-t0; times.push(dt);
      }
      const avg = times.reduce((a,b)=>a+b,0)/times.length;
      const jit = times.reduce((a,b)=>a+Math.abs(b-avg),0)/times.length;
      return {avg, jit};
    }
    async function downloadTest(){
      const t0=performance.now();
      const blob = await fetch(DL_URL+`?cache=${Math.random()}`,{cache:'no-store'}).then(r=>r.blob());
      const t1=performance.now();
      const bytes = blob.size; // bytes
      const sec = (t1-t0)/1000;
      const mbps = (bytes*8/1e6)/Math.max(sec,0.001);
      return mbps;
    }
    document.getElementById('start').addEventListener('click', async ()=>{
      pingEl.textContent='…'; jitterEl.textContent='…'; downEl.textContent='…';
      try{
        const {avg,jit} = await pingTest();
        pingEl.textContent = fmt(avg);
        jitterEl.textContent = fmt(jit);
      }catch(_){ pingEl.textContent='-'; jitterEl.textContent='-'; }
      try{
        const mbps = await downloadTest();
        downEl.textContent = (mbps).toFixed(1);
      }catch(_){ downEl.textContent='-'; }
    });
    document.getElementById('reset').addEventListener('click', ()=>{ pingEl.textContent='-'; jitterEl.textContent='-'; downEl.textContent='-'; });
  </script>
</body>
</html>


